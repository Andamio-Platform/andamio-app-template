# API Endpoint Audit Report
**Date**: 2026-01-10
**Source**: https://andamio-db-api-343753432212.us-central1.run.app/docs/doc.json
**Status**: ✅ **COMPLETE** - All endpoints migrated to Go API RESTful structure

---

## Summary

The Andamio T3 App Template has been fully migrated to use the new Go API RESTful endpoint structure. All 50+ endpoint calls throughout the codebase have been updated.

### Migration Completed

| Phase | Description | Status |
|-------|-------------|--------|
| Phase 1 | Core course display hooks | ✅ Complete |
| Phase 2 | Wizard step components | ✅ Complete |
| Phase 3 | Project page endpoints | ✅ Complete |
| Phase 4 | Learner component endpoints | ✅ Complete |
| Phase 5 | Misc endpoints (sitemap, instructor, etc.) | ✅ Complete |

---

## Go API RESTful Structure

The API now uses this pattern:
```
/{system}/{role}/{resource}/{action}
```

**Systems**: `auth`, `user`, `course`, `project`
**Roles**: `public`, `owner`, `teacher`, `student`, `shared`, `manager`, `contributor`

### Key Changes from Old API

1. **Public endpoints use GET with path parameters** (not POST with body)
2. **Role prefixes** identify authorization requirements
3. **Resource paths** are more explicit (`/course-module/` → `/course/teacher/course-module/`)

---

## Files Modified

### Phase 1: Core Hooks (12 files)

| File | Changes |
|------|---------|
| `src/hooks/api/use-course.ts` | 4 functions updated |
| `src/hooks/api/use-course-module.ts` | 6 functions updated |
| `src/hooks/api/use-slt.ts` | 4 functions updated |
| `src/hooks/api/use-lesson.ts` | 3 functions updated |
| `src/hooks/use-owned-courses.ts` | 2 endpoints updated |
| `src/hooks/use-pending-transactions.ts` | 1 endpoint updated |
| `src/hooks/use-module-wizard-data.ts` | 6 endpoints updated |
| `src/hooks/use-hybrid-slts.ts` | 2 endpoints updated |
| `src/components/auth/require-course-access.tsx` | Ownership check updated |
| `src/components/courses/on-chain-courses-section.tsx` | 2 endpoints updated |
| `src/components/courses/on-chain-modules-section.tsx` | 3 endpoints updated |
| `src/app/(app)/studio/course/page.tsx` | Minting endpoint updated |

### Phase 2: Wizard Steps (7 files)

| File | Changes |
|------|---------|
| `src/components/studio/wizard/steps/step-slts.tsx` | SLT CRUD endpoints |
| `src/components/studio/wizard/steps/step-lessons.tsx` | Lesson CRUD endpoints |
| `src/components/studio/wizard/steps/step-assignment.tsx` | Assignment CRUD endpoints |
| `src/components/studio/wizard/steps/step-introduction.tsx` | Introduction CRUD endpoints |
| `src/components/studio/wizard/steps/step-credential.tsx` | Module status endpoints |
| `src/components/studio/wizard/steps/step-review.tsx` | Module status update |
| `src/components/studio/wizard/module-wizard.tsx` | Data fetching endpoints |

### Phase 3: Project Pages (9 files)

| File | Changes |
|------|---------|
| `src/app/(app)/project/page.tsx` | Public treasury list |
| `src/app/(app)/studio/project/page.tsx` | Owned treasury list |
| `src/app/(app)/project/[treasurynft]/page.tsx` | Task list (GET) |
| `src/app/(app)/project/[treasurynft]/contributor/page.tsx` | Contributor task list |
| `src/app/(app)/project/[treasurynft]/[taskhash]/page.tsx` | Task commitment |
| `src/app/(app)/studio/project/[treasurynft]/page.tsx` | Manager view |
| `src/app/(app)/studio/project/[treasurynft]/manager/page.tsx` | Manager commitments |
| `src/app/(app)/studio/project/[treasurynft]/draft-tasks/page.tsx` | Task delete |
| `src/app/(app)/studio/project/[treasurynft]/draft-tasks/new/page.tsx` | Task create |
| `src/app/(app)/studio/project/[treasurynft]/draft-tasks/[taskindex]/page.tsx` | Task update |

### Phase 4: Learner Components (3 files)

| File | Changes |
|------|---------|
| `src/components/learner/my-learning.tsx` | Student courses endpoint |
| `src/components/learner/user-course-status.tsx` | Course status endpoint |
| `src/components/learner/assignment-commitment.tsx` | All commitment endpoints |

### Phase 5: Miscellaneous (5 files)

| File | Changes |
|------|---------|
| `src/app/(app)/sitemap/page.tsx` | All 4 listing endpoints |
| `src/hooks/use-pending-tx-watcher.ts` | 3 confirmation endpoints |
| `src/app/(app)/studio/course/[coursenft]/instructor/page.tsx` | Teacher commitments |
| `src/components/courses/hybrid-slt-status.tsx` | SLT create endpoint |
| `src/app/(app)/course/[coursenft]/[modulecode]/assignment/page.tsx` | 3 public endpoints |

---

## Endpoint Mapping Reference

### Authentication (No Changes)

| Old Path | New Path | Method |
|----------|----------|--------|
| `/auth/login/session` | `/auth/login/session` | POST |
| `/auth/login/validate` | `/auth/login/validate` | POST |

### User Management

| Old Path | New Path | Method |
|----------|----------|--------|
| `/pending-transactions` | `/user/pending-transactions` | GET |
| `/user/access-token-alias` | `/user/access-token-alias` | POST |
| `/user/unconfirmed-tx` | `/user/unconfirmed-tx` | POST |

### Course Public (POST → GET)

| Old Path | New Path | Method |
|----------|----------|--------|
| `POST /course/get` | `GET /course/public/course/get/{policy_id}` | GET |
| `POST /course/published` | `GET /course/public/courses/list` | GET |
| `POST /course-module/list` | `GET /course/public/course-modules/list/{policy_id}` | GET |
| `POST /course-module/get` | `GET /course/public/course-module/get/{policy_id}/{module_code}` | GET |
| `POST /slt/list` | `GET /course/public/slts/list/{policy_id}/{module_code}` | GET |
| `POST /lesson/list` | `GET /course/public/lessons/list/{policy_id}/{module_code}` | GET |
| `POST /lesson/get` | `GET /course/public/lesson/get/{policy_id}/{module_code}/{index}` | GET |
| `POST /assignment/get` | `GET /course/public/assignment/get/{policy_id}/{module_code}` | GET |
| `POST /introduction/get` | `GET /course/public/introduction/get/{policy_id}/{module_code}` | GET |

### Course Owner

| Old Path | New Path | Method |
|----------|----------|--------|
| `/courses/owned` | `/course/owner/courses/list` | POST |
| `/course/create` | `/course/owner/course/create` | POST |
| `/course/update` | `/course/owner/course/update` | POST |
| `/course/delete` | `/course/owner/course/delete` | POST |
| `/course/create-on-submit-minting-tx` | `/course/owner/course/mint` | POST |

### Course Teacher

| Old Path | New Path | Method |
|----------|----------|--------|
| `/course-modules/list` | `/course/teacher/course-modules/list` | POST |
| `/course-module/create` | `/course/teacher/course-module/create` | POST |
| `/course-module/update` | `/course/teacher/course-module/update` | POST |
| `/course-module/update-status` | `/course/teacher/course-module/update-status` | POST |
| `/course-module/confirm-transaction` | `/course/teacher/course-module/confirm-tx` | POST |
| `/slt/create` | `/course/teacher/slt/create` | POST |
| `/slt/update` | `/course/teacher/slt/update` | POST |
| `/slt/delete` | `/course/teacher/slt/delete` | POST |
| `/slt/reorder` | `/course/teacher/slts/batch-update-indexes` | POST |
| `/lesson/create` | `/course/teacher/lesson/create` | POST |
| `/lesson/update` | `/course/teacher/lesson/update` | POST |
| `/assignment/create` | `/course/teacher/assignment/create` | POST |
| `/assignment/update` | `/course/teacher/assignment/update` | POST |
| `/introduction/create` | `/course/teacher/introduction/create` | POST |
| `/introduction/update` | `/course/teacher/introduction/update` | POST |
| `/assignment-commitment/by-course` | `/course/teacher/assignment-commitments/list-by-course` | POST |

### Course Student

| Old Path | New Path | Method |
|----------|----------|--------|
| `/learner/my-learning` | `/course/student/courses` | POST |
| `/assignment-commitment/list` | `/course/student/assignment-commitments/list-by-course` | POST |
| `/assignment-commitment/update-evidence` | `/course/student/assignment-commitment/update-evidence` | POST |
| `/assignment-commitment/delete` | `/course/student/assignment-commitment/delete` | POST |

### Course Shared

| Old Path | New Path | Method |
|----------|----------|--------|
| `/assignment-commitment/update-status` | `/course/shared/assignment-commitment/update-status` | POST |

### Project Public (POST → GET for task list)

| Old Path | New Path | Method |
|----------|----------|--------|
| `POST /projects/list` | `POST /project/public/treasury/list` | POST |
| `POST /tasks/list` | `GET /project/public/tasks/list/{treasury_nft_policy_id}` | GET |

### Project Owner

| Old Path | New Path | Method |
|----------|----------|--------|
| `/projects/list-owned` | `/project/owner/treasury/list-owned` | POST |
| `/projects/update` | `/project/owner/treasury/update` | POST |

### Project Manager

| Old Path | New Path | Method |
|----------|----------|--------|
| `/tasks/create` | `/project/manager/task/create` | POST |
| `/tasks/update` | `/project/manager/task/update` | POST |
| `/tasks/delete` | `/project/owner/task/delete` | POST |

### Project Contributor

| Old Path | New Path | Method |
|----------|----------|--------|
| `/task-commitments/get` | `/project/contributor/commitment/get` | POST |

---

## Verification

After migration, verify endpoints by:

1. **Start the dev server**: `npm run dev`
2. **Test course display**: Navigate to `/studio/course` - should show courses with DB data
3. **Test module wizard**: Edit a course module - all steps should load data
4. **Test learner features**: `/my-learning` should show enrolled courses
5. **Test project features**: `/project` and `/studio/project` should display data

---

## Notes

- All public endpoints now use GET with path parameters for better caching and RESTful compliance
- Authenticated endpoints remain POST for security (no sensitive data in URLs)
- The `/user/init-roles` endpoint replaces separate `/creator/create` and `/learner/create` calls
- Batch operations (`batch-update-status`, `batch-confirm`) are available but not yet implemented in the UI

---

**Report Generated**: January 10, 2026
**Migration Completed**: January 10, 2026
